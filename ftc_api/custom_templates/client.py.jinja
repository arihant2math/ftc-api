import base64
import ssl
from typing import Dict, Union


class Client:
    """A class for keeping track of data related to the API"""

    cookies = {}
    headers: Dict[str, str] = {}
    timeout: float = 5.0
    verify_ssl: Union[str, bool, ssl.SSLContext] = True
    raise_on_unexpected_status: bool = False
    prefix: str = "Basic"
    auth_header_name: str = "Authorization"

    def __init__(self, token=None, username="", authorization_key=""):
        if token is not None:
            self.token = token
        else:
            token = username + ":" + authorization_key
            token_bytes = token.encode("ascii")
            base64_bytes = base64.b64encode(token_bytes)
            self.token = base64_bytes.decode("ascii")

    def get_headers(self) -> Dict[str, str]:
        auth_header_value = f"{self.prefix} {self.token}" if self.prefix else self.token
        """Get headers to be used in authenticated endpoints"""
        return {self.auth_header_name: auth_header_value, **self.headers}

    def get_cookies(self) -> Dict[str, str]:
        return {**self.cookies}

    def get_timeout(self) -> float:
        return self.timeout


class AuthenticatedClient(Client):
    """Deprecated, use Client instead, as it has equivalent functionality, will be removed v1.0.0"""
    pass
